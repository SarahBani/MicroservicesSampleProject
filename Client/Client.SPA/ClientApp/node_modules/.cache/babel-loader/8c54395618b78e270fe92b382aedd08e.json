{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Auth = void 0;\n\nvar React = require(\"react\");\n\nvar react_1 = require(\"react\");\n\nvar react_redux_1 = require(\"react-redux\");\n\nvar react_router_1 = require(\"react-router\");\n\nvar classes = require(\"./Auth.module.scss\");\n\nvar FormElement_1 = require(\"../UI/FormElement/FormElement\");\n\nvar Button_1 = require(\"../UI/Button/Button\");\n\nvar withErrorHandler_1 = require(\"../../hoc/withErrorHandler/withErrorHandler\");\n\nvar utility_1 = require(\"../../shared/utility\");\n\nvar actions = require(\"../../store/actions/authActions\");\n\nvar enums_1 = require(\"../../shared/enums\");\n\nvar initialFormState = {\n  email: {\n    elementType: enums_1.FormControlType.Input,\n    elementConfig: {\n      type: enums_1.ElementConfigType.Email,\n      placeholder: 'Email'\n    },\n    value: 'sarah@yahoo.com',\n    validation: {\n      required: true,\n      email: true\n    },\n    valid: true\n  },\n  password: {\n    elementType: enums_1.FormControlType.Input,\n    elementConfig: {\n      type: enums_1.ElementConfigType.Password,\n      placeholder: 'Password'\n    },\n    value: '',\n    autoComplete: 'on',\n    validation: {\n      required: true,\n      minLength: 6\n    },\n    valid: true\n  }\n};\n\nvar Auth = function Auth() {\n  var _a = react_redux_1.useSelector(function (state) {\n    return {\n      isLoggedIn: state.auth.loggedIn,\n      isLoading: state.common.isLoading,\n      authRedirectPath: state.auth.authRedirectPath\n    };\n  }),\n      isLoggedIn = _a.isLoggedIn,\n      isLoading = _a.isLoading,\n      authRedirectPath = _a.authRedirectPath;\n\n  var dispatch = react_redux_1.useDispatch();\n  var history = react_router_1.useHistory();\n\n  var _b = react_1.useState(initialFormState),\n      formControls = _b[0],\n      setFormControls = _b[1];\n\n  var _c = react_1.useState(false),\n      isFormValid = _c[0],\n      setIsFormValid = _c[1];\n\n  react_1.useEffect(function () {\n    if (history.action !== 'REPLACE') {\n      dispatch(actions.setAuthRedirectPath('/'));\n    }\n  }, []);\n  react_1.useEffect(function () {\n    var updatedForm = utility_1.disableForm(formControls, isLoading);\n    setFormControls(updatedForm);\n  }, [isLoading, setFormControls]);\n\n  var elementChangedHandler = function elementChangedHandler(event, id) {\n    var updatedForm = utility_1.getUpdatedForm(event, formControls, id);\n    setFormControls(updatedForm);\n    setIsFormValid(utility_1.ValidateForm(updatedForm));\n  };\n\n  var elementLostFocusHandler = function elementLostFocusHandler(event, id) {\n    setFormControls(utility_1.getUpdatedForm(event, formControls, id));\n  };\n\n  var signInHandler = function signInHandler(event) {\n    event.preventDefault();\n    dispatch(actions.signIn(formControls.email.value, formControls.password.value));\n  };\n\n  var loggedInRedirect = isLoggedIn && React.createElement(react_router_1.Redirect, {\n    to: authRedirectPath\n  });\n  var form = React.createElement(\"form\", {\n    onSubmit: signInHandler\n  }, utility_1.getFormElements(formControls).map(function (formElement) {\n    return React.createElement(FormElement_1.default, {\n      formElement: formElement,\n      key: formElement.id,\n      onChange: function onChange(event) {\n        return elementChangedHandler(event, formElement.id);\n      },\n      onLostFocus: function onLostFocus(event) {\n        return elementLostFocusHandler(event, formElement.id);\n      }\n    });\n  }), React.createElement(Button_1.default, {\n    type: enums_1.ButtonType.Success,\n    disabled: !isFormValid || isLoading\n  }, \"Sign In\"));\n  return React.createElement(\"div\", {\n    className: classes.Auth\n  }, loggedInRedirect, form);\n};\n\nexports.Auth = Auth;\nexports.default = withErrorHandler_1.default(exports.Auth);","map":{"version":3,"sources":["Auth.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Auth = void 0;\r\nvar React = require(\"react\");\r\nvar react_1 = require(\"react\");\r\nvar react_redux_1 = require(\"react-redux\");\r\nvar react_router_1 = require(\"react-router\");\r\nvar classes = require(\"./Auth.module.scss\");\r\nvar FormElement_1 = require(\"../UI/FormElement/FormElement\");\r\nvar Button_1 = require(\"../UI/Button/Button\");\r\nvar withErrorHandler_1 = require(\"../../hoc/withErrorHandler/withErrorHandler\");\r\nvar utility_1 = require(\"../../shared/utility\");\r\nvar actions = require(\"../../store/actions/authActions\");\r\nvar enums_1 = require(\"../../shared/enums\");\r\nvar initialFormState = {\r\n    email: {\r\n        elementType: enums_1.FormControlType.Input,\r\n        elementConfig: {\r\n            type: enums_1.ElementConfigType.Email,\r\n            placeholder: 'Email',\r\n        },\r\n        value: 'sarah@yahoo.com',\r\n        validation: {\r\n            required: true,\r\n            email: true\r\n        },\r\n        valid: true\r\n    },\r\n    password: {\r\n        elementType: enums_1.FormControlType.Input,\r\n        elementConfig: {\r\n            type: enums_1.ElementConfigType.Password,\r\n            placeholder: 'Password',\r\n        },\r\n        value: '',\r\n        autoComplete: 'on',\r\n        validation: {\r\n            required: true,\r\n            minLength: 6\r\n        },\r\n        valid: true\r\n    }\r\n};\r\nvar Auth = function () {\r\n    var _a = react_redux_1.useSelector(function (state) { return ({\r\n        isLoggedIn: state.auth.loggedIn,\r\n        isLoading: state.common.isLoading,\r\n        authRedirectPath: state.auth.authRedirectPath\r\n    }); }), isLoggedIn = _a.isLoggedIn, isLoading = _a.isLoading, authRedirectPath = _a.authRedirectPath;\r\n    var dispatch = react_redux_1.useDispatch();\r\n    var history = react_router_1.useHistory();\r\n    var _b = react_1.useState(initialFormState), formControls = _b[0], setFormControls = _b[1];\r\n    var _c = react_1.useState(false), isFormValid = _c[0], setIsFormValid = _c[1];\r\n    react_1.useEffect(function () {\r\n        if (history.action !== 'REPLACE') {\r\n            dispatch(actions.setAuthRedirectPath('/'));\r\n        }\r\n    }, []);\r\n    react_1.useEffect(function () {\r\n        var updatedForm = utility_1.disableForm(formControls, isLoading);\r\n        setFormControls(updatedForm);\r\n    }, [isLoading, setFormControls]);\r\n    var elementChangedHandler = function (event, id) {\r\n        var updatedForm = utility_1.getUpdatedForm(event, formControls, id);\r\n        setFormControls(updatedForm);\r\n        setIsFormValid(utility_1.ValidateForm(updatedForm));\r\n    };\r\n    var elementLostFocusHandler = function (event, id) {\r\n        setFormControls(utility_1.getUpdatedForm(event, formControls, id));\r\n    };\r\n    var signInHandler = function (event) {\r\n        event.preventDefault();\r\n        dispatch(actions.signIn(formControls.email.value, formControls.password.value));\r\n    };\r\n    var loggedInRedirect = (isLoggedIn && React.createElement(react_router_1.Redirect, { to: authRedirectPath }));\r\n    var form = (React.createElement(\"form\", { onSubmit: signInHandler },\r\n        utility_1.getFormElements(formControls).map(function (formElement) { return (React.createElement(FormElement_1.default, { formElement: formElement, key: formElement.id, onChange: function (event) { return elementChangedHandler(event, formElement.id); }, onLostFocus: function (event) { return elementLostFocusHandler(event, formElement.id); } })); }),\r\n        React.createElement(Button_1.default, { type: enums_1.ButtonType.Success, disabled: !isFormValid || isLoading }, \"Sign In\")));\r\n    return (React.createElement(\"div\", { className: classes.Auth },\r\n        loggedInRedirect,\r\n        form));\r\n};\r\nexports.Auth = Auth;\r\nexports.default = withErrorHandler_1.default(exports.Auth);\r\n//# sourceMappingURL=Auth.js.map"]},"metadata":{},"sourceType":"module"}