{"ast":null,"code":"import _regeneratorRuntime from \"H:/Project/Microservices/MicroservicesSampleProject/Client/Client.SPA/ClientApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\n\nvar _marked = /*#__PURE__*/_regeneratorRuntime.mark(fetchBanksSaga),\n    _marked2 = /*#__PURE__*/_regeneratorRuntime.mark(fetchBanksCountSaga),\n    _marked3 = /*#__PURE__*/_regeneratorRuntime.mark(fetchBankSaga),\n    _marked4 = /*#__PURE__*/_regeneratorRuntime.mark(uploadBankLogoSaga),\n    _marked5 = /*#__PURE__*/_regeneratorRuntime.mark(removeBankLogoSaga),\n    _marked6 = /*#__PURE__*/_regeneratorRuntime.mark(saveBankSaga),\n    _marked7 = /*#__PURE__*/_regeneratorRuntime.mark(deleteBankSaga);\n\nimport { call, put, take } from 'redux-saga/effects';\nimport { SuccessfulOperationEnum, FailedOperationEnum } from '../../shared/enums';\nimport * as actions from '../actions/bankActions';\nimport * as commonActions from '../actions/commonActions';\nimport * as uploadActions from '../actions/uploadActions'; //import uploadFileChannel from './uploadFileChannel';\n\nimport axiosInstance from '../../shared/axios-instance';\nimport uploadFileChannel from './uploadFileChannel'; //const cancelSource = axios.CancelToken.source();\n\nexport function fetchBanksSaga(action) {\n  var headers, filters, queryString, response;\n  return _regeneratorRuntime.wrap(function fetchBanksSaga$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.next = 2;\n          return put(commonActions.showLoader());\n\n        case 2:\n          headers = {\n            'Content-Type': 'application/json; charset=utf-8'\n          };\n          _context.prev = 3;\n          filters = [];\n\n          if (!action.cityId) {\n            _context.next = 8;\n            break;\n          }\n\n          _context.next = 8;\n          return filters.push(\"cityId=\".concat(action.cityId));\n\n        case 8:\n          if (!action.countryId) {\n            _context.next = 11;\n            break;\n          }\n\n          _context.next = 11;\n          return filters.push(\"countryId=\".concat(action.countryId));\n\n        case 11:\n          if (!action.pageNo) {\n            _context.next = 14;\n            break;\n          }\n\n          _context.next = 14;\n          return filters.push(\"pageNo=\".concat(action.pageNo));\n\n        case 14:\n          if (!action.pageCount) {\n            _context.next = 17;\n            break;\n          }\n\n          _context.next = 17;\n          return filters.push(\"pageCount=\".concat(action.pageCount));\n\n        case 17:\n          _context.next = 19;\n          return filters.length > 0 ? '?' + filters.join('&') : '';\n\n        case 19:\n          queryString = _context.sent;\n          _context.next = 22;\n          return axiosInstance.get('/banks' + queryString, {\n            headers: headers //cancelToken: cancelSource.token\n\n          });\n\n        case 22:\n          response = _context.sent;\n\n          if (!((response === null || response === void 0 ? void 0 : response.status) === 200)) {\n            _context.next = 26;\n            break;\n          }\n\n          _context.next = 26;\n          return put(actions.setBanks(response.data));\n\n        case 26:\n          _context.next = 28;\n          return put(commonActions.hideLoader());\n\n        case 28:\n          _context.next = 34;\n          break;\n\n        case 30:\n          _context.prev = 30;\n          _context.t0 = _context[\"catch\"](3);\n          _context.next = 34;\n          return put(commonActions.raiseError(_context.t0));\n\n        case 34:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked, null, [[3, 30]]);\n}\nexport function fetchBanksCountSaga(action) {\n  var headers, filters, queryString, response;\n  return _regeneratorRuntime.wrap(function fetchBanksCountSaga$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.next = 2;\n          return put(commonActions.showLoader());\n\n        case 2:\n          headers = {\n            'Content-Type': 'application/json; charset=utf-8'\n          };\n          _context2.prev = 3;\n          filters = [];\n\n          if (!action.cityId) {\n            _context2.next = 8;\n            break;\n          }\n\n          _context2.next = 8;\n          return filters.push(\"cityId=\".concat(action.cityId));\n\n        case 8:\n          if (!action.countryId) {\n            _context2.next = 11;\n            break;\n          }\n\n          _context2.next = 11;\n          return filters.push(\"countryId=\".concat(action.countryId));\n\n        case 11:\n          _context2.next = 13;\n          return filters.length > 0 ? '?' + filters.join('&') : '';\n\n        case 13:\n          queryString = _context2.sent;\n          _context2.next = 16;\n          return axiosInstance.get('/bank/count' + queryString, {\n            headers: headers\n          });\n\n        case 16:\n          response = _context2.sent;\n\n          if (!((response === null || response === void 0 ? void 0 : response.status) === 200)) {\n            _context2.next = 20;\n            break;\n          }\n\n          _context2.next = 20;\n          return put(actions.setBanksCount(response.data));\n\n        case 20:\n          _context2.next = 22;\n          return put(commonActions.hideLoader());\n\n        case 22:\n          _context2.next = 28;\n          break;\n\n        case 24:\n          _context2.prev = 24;\n          _context2.t0 = _context2[\"catch\"](3);\n          _context2.next = 28;\n          return put(commonActions.raiseError(_context2.t0));\n\n        case 28:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _marked2, null, [[3, 24]]);\n}\nexport function fetchBankSaga(action) {\n  var headers, response;\n  return _regeneratorRuntime.wrap(function fetchBankSaga$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.next = 2;\n          return put(commonActions.showLoader());\n\n        case 2:\n          headers = {\n            'Content-Type': 'application/json; charset=utf-8'\n          };\n          _context3.prev = 3;\n          _context3.next = 6;\n          return axiosInstance.get('/bank/' + action.id, {\n            headers: headers\n          });\n\n        case 6:\n          response = _context3.sent;\n\n          if (!((response === null || response === void 0 ? void 0 : response.status) === 200)) {\n            _context3.next = 12;\n            break;\n          }\n\n          _context3.next = 10;\n          return put(actions.setBank(response.data));\n\n        case 10:\n          _context3.next = 14;\n          break;\n\n        case 12:\n          _context3.next = 14;\n          return put(commonActions.operationFailed(FailedOperationEnum.FetchBank));\n\n        case 14:\n          _context3.next = 16;\n          return put(commonActions.hideLoader());\n\n        case 16:\n          _context3.next = 22;\n          break;\n\n        case 18:\n          _context3.prev = 18;\n          _context3.t0 = _context3[\"catch\"](3);\n          _context3.next = 22;\n          return put(commonActions.raiseError(_context3.t0));\n\n        case 22:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, _marked3, null, [[3, 18]]);\n}\nexport function uploadBankLogoSaga(action) {\n  var formData, channel, _yield$take, _yield$take$progress, progress, err, success, filePath, imageUrl;\n\n  return _regeneratorRuntime.wrap(function uploadBankLogoSaga$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          _context4.next = 2;\n          return put(commonActions.showLoader());\n\n        case 2:\n          _context4.next = 4;\n          return put(uploadActions.startUpload());\n\n        case 4:\n          formData = new FormData();\n          formData.append(\"file\", action.file, action.file.name);\n          _context4.next = 8;\n          return call(uploadFileChannel, \"/Bank/UploadLogo/\".concat(action.hotelId), formData, action.token);\n\n        case 8:\n          channel = _context4.sent;\n\n        case 9:\n          if (!true) {\n            _context4.next = 27;\n            break;\n          }\n\n          _context4.next = 12;\n          return take(channel);\n\n        case 12:\n          _yield$take = _context4.sent;\n          _yield$take$progress = _yield$take.progress;\n          progress = _yield$take$progress === void 0 ? 0 : _yield$take$progress;\n          err = _yield$take.err;\n          success = _yield$take.success;\n          filePath = _yield$take.filePath;\n\n          if (!err) {\n            _context4.next = 22;\n            break;\n          }\n\n          _context4.next = 21;\n          return put(commonActions.raiseError(err));\n\n        case 21:\n          return _context4.abrupt(\"return\");\n\n        case 22:\n          if (success) {\n            imageUrl = filePath.replace('Resources\\\\Images\\\\Banks\\\\', '').replace('\\\\', '/');\n            console.log(3333333333);\n            console.log(imageUrl); //yield put(actions.saveHotelPhoto({\n            //    hotelId: action.hotelId,\n            //    photoUrl: imageUrl\n            //}, action.token));\n          }\n\n          _context4.next = 25;\n          return put(uploadActions.showProgress(progress));\n\n        case 25:\n          _context4.next = 9;\n          break;\n\n        case 27:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, _marked4);\n}\nexport function removeBankLogoSaga(action) {\n  var headers, response;\n  return _regeneratorRuntime.wrap(function removeBankLogoSaga$(_context5) {\n    while (1) {\n      switch (_context5.prev = _context5.next) {\n        case 0:\n          _context5.next = 2;\n          return put(commonActions.showLoader());\n\n        case 2:\n          headers = {\n            'Content-Type': 'application/json; charset=utf-8',\n            Authorization: \"Bearer \".concat(action.token)\n          };\n          _context5.prev = 3;\n          _context5.next = 6;\n          return axiosInstance.delete(\"/Bank/RemoveLogoFile?filePath=\".concat(action.filePath), {\n            headers: headers\n          });\n\n        case 6:\n          response = _context5.sent;\n\n          if ((response === null || response === void 0 ? void 0 : response.status) === 200) {\n            console.log(433333334444); //yield put(actions.deleteBankLogo(action.id, action.token));\n          }\n\n          _context5.next = 10;\n          return put(commonActions.hideLoader());\n\n        case 10:\n          _context5.next = 16;\n          break;\n\n        case 12:\n          _context5.prev = 12;\n          _context5.t0 = _context5[\"catch\"](3);\n          _context5.next = 16;\n          return put(commonActions.raiseError(_context5.t0));\n\n        case 16:\n        case \"end\":\n          return _context5.stop();\n      }\n    }\n  }, _marked5, null, [[3, 12]]);\n}\nexport function saveBankSaga(action) {\n  var headers, response, _response, _response2;\n\n  return _regeneratorRuntime.wrap(function saveBankSaga$(_context6) {\n    while (1) {\n      switch (_context6.prev = _context6.next) {\n        case 0:\n          _context6.next = 2;\n          return put(commonActions.showLoader());\n\n        case 2:\n          headers = {\n            'Content-Type': 'application/json; charset=utf-8',\n            'Authorization': \"Bearer \".concat(action.token)\n          };\n          _context6.prev = 3;\n\n          if (action.bank.id) {\n            _context6.next = 13;\n            break;\n          }\n\n          _context6.next = 7;\n          return axiosInstance.post('/bank', action.bank, {\n            headers: headers\n          });\n\n        case 7:\n          response = _context6.sent;\n\n          if (!(((_response = response) === null || _response === void 0 ? void 0 : _response.status) === 201)) {\n            _context6.next = 11;\n            break;\n          }\n\n          _context6.next = 11;\n          return put(commonActions.operationSucceeded(SuccessfulOperationEnum.Insert));\n\n        case 11:\n          _context6.next = 19;\n          break;\n\n        case 13:\n          _context6.next = 15;\n          return axiosInstance.put('/bank', action.bank, {\n            headers: headers\n          });\n\n        case 15:\n          response = _context6.sent;\n\n          if (!(((_response2 = response) === null || _response2 === void 0 ? void 0 : _response2.status) === 200)) {\n            _context6.next = 19;\n            break;\n          }\n\n          _context6.next = 19;\n          return put(commonActions.operationSucceeded(SuccessfulOperationEnum.Update));\n\n        case 19:\n          _context6.next = 21;\n          return put(commonActions.hideLoader());\n\n        case 21:\n          _context6.next = 28;\n          break;\n\n        case 23:\n          _context6.prev = 23;\n          _context6.t0 = _context6[\"catch\"](3);\n          console.log(_context6.t0);\n          _context6.next = 28;\n          return put(commonActions.raiseError(_context6.t0));\n\n        case 28:\n        case \"end\":\n          return _context6.stop();\n      }\n    }\n  }, _marked6, null, [[3, 23]]);\n}\nexport function deleteBankSaga(action) {\n  var headers, response;\n  return _regeneratorRuntime.wrap(function deleteBankSaga$(_context7) {\n    while (1) {\n      switch (_context7.prev = _context7.next) {\n        case 0:\n          _context7.next = 2;\n          return put(commonActions.showLoader());\n\n        case 2:\n          headers = {\n            'Content-Type': 'application/json; charset=utf-8',\n            Authorization: \"Bearer \".concat(action.token)\n          };\n          _context7.prev = 3;\n          _context7.next = 6;\n          return axiosInstance.delete('/bank/' + action.id, {\n            headers: headers\n          });\n\n        case 6:\n          response = _context7.sent;\n\n          if (!((response === null || response === void 0 ? void 0 : response.status) === 200)) {\n            _context7.next = 12;\n            break;\n          }\n\n          _context7.next = 10;\n          return put(commonActions.operationSucceeded(SuccessfulOperationEnum.Delete));\n\n        case 10:\n          _context7.next = 12;\n          return put(actions.clearSelectedBank());\n\n        case 12:\n          _context7.next = 14;\n          return put(commonActions.hideLoader());\n\n        case 14:\n          _context7.next = 20;\n          break;\n\n        case 16:\n          _context7.prev = 16;\n          _context7.t0 = _context7[\"catch\"](3);\n          _context7.next = 20;\n          return put(commonActions.raiseError(_context7.t0));\n\n        case 20:\n        case \"end\":\n          return _context7.stop();\n      }\n    }\n  }, _marked7, null, [[3, 16]]);\n}","map":{"version":3,"sources":["H:/Project/Microservices/MicroservicesSampleProject/Client/Client.SPA/ClientApp/src/store/sagas/bank.ts"],"names":["fetchBanksSaga","fetchBanksCountSaga","fetchBankSaga","uploadBankLogoSaga","removeBankLogoSaga","saveBankSaga","deleteBankSaga","call","put","take","SuccessfulOperationEnum","FailedOperationEnum","actions","commonActions","uploadActions","axiosInstance","uploadFileChannel","action","showLoader","headers","filters","cityId","push","countryId","pageNo","pageCount","length","join","queryString","get","response","status","setBanks","data","hideLoader","raiseError","setBanksCount","id","setBank","operationFailed","FetchBank","startUpload","formData","FormData","append","file","name","hotelId","token","channel","progress","err","success","filePath","imageUrl","replace","console","log","showProgress","Authorization","delete","bank","post","operationSucceeded","Insert","Update","Delete","clearSelectedBank"],"mappings":"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","sourcesContent":["import { call, put, take } from 'redux-saga/effects';\r\n\r\nimport { SuccessfulOperationEnum, FailedOperationEnum } from '../../shared/enums';\r\nimport * as actions from '../actions/bankActions';\r\nimport * as commonActions from '../actions/commonActions';\r\nimport * as uploadActions from '../actions/uploadActions';\r\n//import uploadFileChannel from './uploadFileChannel';\r\nimport { ResponseGenerator } from '../../models/ResponseGenerator.model';\r\nimport axiosInstance from '../../shared/axios-instance';\r\nimport uploadFileChannel from './uploadFileChannel';\r\n\r\n//const cancelSource = axios.CancelToken.source();\r\n\r\nexport function* fetchBanksSaga(action: any) {\r\n    yield put(commonActions.showLoader());\r\n    const headers = {\r\n        'Content-Type': 'application/json; charset=utf-8'\r\n    };\r\n    try {\r\n        const filters = [];\r\n        if (action.cityId) {\r\n            yield filters.push(`cityId=${action.cityId}`);\r\n        }\r\n        if (action.countryId) {\r\n            yield filters.push(`countryId=${action.countryId}`);\r\n        }\r\n        if (action.pageNo) {\r\n            yield filters.push(`pageNo=${action.pageNo}`);\r\n        }\r\n        if (action.pageCount) {\r\n            yield filters.push(`pageCount=${action.pageCount}`);\r\n        }\r\n        const queryString: string = yield (filters.length > 0 ? '?' + filters.join('&') : '');\r\n        const response: ResponseGenerator = yield axiosInstance.get('/banks' + queryString,\r\n            {\r\n                headers: headers,\r\n                //cancelToken: cancelSource.token\r\n            });\r\n        if (response?.status === 200) {\r\n            yield put(actions.setBanks(response.data));\r\n        }\r\n        yield put(commonActions.hideLoader());\r\n    } catch (error) {\r\n        yield put(commonActions.raiseError(error));\r\n    }\r\n}\r\n\r\nexport function* fetchBanksCountSaga(action: any) {\r\n    yield put(commonActions.showLoader());\r\n    const headers = {\r\n        'Content-Type': 'application/json; charset=utf-8'\r\n    };\r\n    try {\r\n        const filters = [];\r\n        if (action.cityId) {\r\n            yield filters.push(`cityId=${action.cityId}`);\r\n        }\r\n        if (action.countryId) {\r\n            yield filters.push(`countryId=${action.countryId}`);\r\n        }\r\n        const queryString: string = yield (filters.length > 0 ? '?' + filters.join('&') : '');\r\n        const response: ResponseGenerator = yield axiosInstance.get('/bank/count' + queryString, { headers: headers });\r\n        if (response?.status === 200) {\r\n            yield put(actions.setBanksCount(response.data));\r\n        }\r\n        yield put(commonActions.hideLoader());\r\n    } catch (error) {\r\n        yield put(commonActions.raiseError(error));\r\n    }\r\n}\r\n\r\nexport function* fetchBankSaga(action: any) {\r\n    yield put(commonActions.showLoader());\r\n    const headers = {\r\n        'Content-Type': 'application/json; charset=utf-8'\r\n    };\r\n    try {\r\n        const response: ResponseGenerator = yield axiosInstance.get('/bank/' + action.id, { headers: headers });\r\n        if (response?.status === 200) {\r\n            yield put(actions.setBank(response.data));\r\n        }\r\n        else {\r\n            yield put(commonActions.operationFailed(FailedOperationEnum.FetchBank));\r\n        }\r\n        yield put(commonActions.hideLoader());\r\n    } catch (error) {\r\n        yield put(commonActions.raiseError(error));\r\n    }\r\n}\r\n\r\nexport function* uploadBankLogoSaga(action: any) {\r\n    yield put(commonActions.showLoader());\r\n    yield put(uploadActions.startUpload());\r\n\r\n    const formData = new FormData();\r\n    formData.append(\"file\", action.file, action.file.name);\r\n    const channel = yield call(uploadFileChannel,\r\n        `/Bank/UploadLogo/${action.hotelId}`,\r\n        formData,\r\n        action.token);\r\n\r\n    while (true) {\r\n        const { progress = 0, err, success, filePath } = yield take(channel);\r\n        if (err) {\r\n            yield put(commonActions.raiseError(err));\r\n            return;\r\n        }\r\n        if (success) {\r\n            const imageUrl = filePath.replace('Resources\\\\Images\\\\Banks\\\\', '').replace('\\\\', '/');\r\n            console.log(3333333333);\r\n            console.log(imageUrl);\r\n            //yield put(actions.saveHotelPhoto({\r\n            //    hotelId: action.hotelId,\r\n            //    photoUrl: imageUrl\r\n            //}, action.token));\r\n        }\r\n        yield put(uploadActions.showProgress(progress));\r\n    }\r\n}\r\n\r\nexport function* removeBankLogoSaga(action) {\r\n    yield put(commonActions.showLoader());\r\n    const headers = {\r\n        'Content-Type': 'application/json; charset=utf-8',\r\n        Authorization: `Bearer ${action.token}`\r\n    };\r\n    try {\r\n        const response = yield axiosInstance.delete(`/Bank/RemoveLogoFile?filePath=${action.filePath}`, { headers: headers });\r\n        if (response?.status === 200) {\r\n            console.log(433333334444);\r\n            //yield put(actions.deleteBankLogo(action.id, action.token));\r\n        }\r\n        yield put(commonActions.hideLoader());\r\n    } catch (error) {\r\n        yield put(commonActions.raiseError(error));\r\n    }\r\n}\r\n\r\nexport function* saveBankSaga(action: any) {\r\n    yield put(commonActions.showLoader());\r\n    const headers = {\r\n        'Content-Type': 'application/json; charset=utf-8',\r\n        'Authorization': `Bearer ${action.token}`\r\n    };\r\n    try {\r\n        let response: ResponseGenerator;\r\n        if (!action.bank.id) {\r\n            response = yield axiosInstance.post('/bank', action.bank, { headers: headers });\r\n            if (response?.status === 201) {\r\n                yield put(commonActions.operationSucceeded(SuccessfulOperationEnum.Insert));\r\n            }\r\n        }\r\n        else {\r\n            response = yield axiosInstance.put('/bank', action.bank, { headers: headers });\r\n            if (response?.status === 200) {\r\n                yield put(commonActions.operationSucceeded(SuccessfulOperationEnum.Update));\r\n            }\r\n        }\r\n        yield put(commonActions.hideLoader());\r\n    } catch (error) {\r\n        console.log(error);\r\n        yield put(commonActions.raiseError(error));\r\n    }\r\n}\r\n\r\nexport function* deleteBankSaga(action: any) {\r\n    yield put(commonActions.showLoader());\r\n    const headers = {\r\n        'Content-Type': 'application/json; charset=utf-8',\r\n        Authorization: `Bearer ${action.token}`\r\n    };\r\n    try {\r\n        const response: ResponseGenerator = yield axiosInstance.delete('/bank/' + action.id, { headers: headers });\r\n        if (response?.status === 200) {\r\n            yield put(commonActions.operationSucceeded(SuccessfulOperationEnum.Delete));\r\n            yield put(actions.clearSelectedBank());\r\n        }\r\n        yield put(commonActions.hideLoader());\r\n    } catch (error) {\r\n        yield put(commonActions.raiseError(error));\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}