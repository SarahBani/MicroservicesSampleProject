{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar React = require(\"react\");\n\nvar react_1 = require(\"react\");\n\nvar react_router_dom_1 = require(\"react-router-dom\");\n\nvar react_redux_1 = require(\"react-redux\");\n\nvar utility_1 = require(\"../../../shared/utility\");\n\nvar FormElement_1 = require(\"../../UI/FormElement/FormElement\");\n\nvar ConfirmDelete_1 = require(\"../../UI/ConfirmDelete/ConfirmDelete\");\n\nvar Modal_1 = require(\"../../UI/Modal/Modal\");\n\nvar enums_1 = require(\"../../../shared/enums\");\n\nvar actions = require(\"../../../store/actions/bankActions\");\n\nvar authActions = require(\"../../../store/actions/authActions\");\n\n;\nvar initialFormState = {\n  name: {\n    elementType: enums_1.ElementTypeEnum.Input,\n    elementConfig: {\n      type: enums_1.ElementConfigTypeEnum.Text,\n      placeholder: 'Name'\n    },\n    value: '',\n    validation: {\n      required: true\n    },\n    valid: false\n  },\n  //grade: {\n  //    elementType: ElementTypeEnum.Input,\n  //    elementConfig: {\n  //        type: ElementConfigTypeEnum.Number,\n  //        placeholder: 'Grade',\n  //    },\n  //    value: '',\n  //    validation: {\n  //        required: true\n  //    },\n  //    valid: false\n  //}\n  grade: {\n    elementType: enums_1.ElementTypeEnum.Select,\n    elementConfig: {\n      placeholder: 'Grade',\n      options: [{\n        value: '',\n        text: '---'\n      }, {\n        value: '1',\n        text: 'A'\n      }, {\n        value: '2',\n        text: 'B'\n      }, {\n        value: '3',\n        text: 'C'\n      }, {\n        value: '4',\n        text: 'D'\n      }, {\n        value: '5',\n        text: 'E'\n      }]\n    },\n    value: '',\n    validation: {},\n    valid: true\n  }\n};\nvar BankEdit = react_1.memo(function (_a) {\n  var id = _a.id;\n\n  var _b = react_redux_1.useSelector(function (state) {\n    return {\n      bank: state.bank.selectedBank,\n      loggedIn: state.auth.loggedIn,\n      token: state.auth.token,\n      loading: state.common.isLoading,\n      successfulOperation: state.common.successfulOperation,\n      failedOperation: state.common.failedOperation\n    };\n  }),\n      bank = _b.bank,\n      loggedIn = _b.loggedIn,\n      token = _b.token,\n      loading = _b.loading,\n      successfulOperation = _b.successfulOperation,\n      failedOperation = _b.failedOperation;\n\n  var dispatch = react_redux_1.useDispatch();\n  var location = react_router_dom_1.useLocation();\n\n  var _c = react_1.useState(initialFormState),\n      formControls = _c[0],\n      setFormControls = _c[1];\n\n  var _d = react_1.useState(false),\n      isFormValid = _d[0],\n      setIsFormValid = _d[1];\n\n  var _e = react_1.useState(),\n      redirect = _e[0],\n      setRedirect = _e[1];\n\n  var _f = react_1.useState(false),\n      isDeleteConfirmShown = _f[0],\n      setIsDeleteConfirmShown = _f[1];\n\n  var _g = react_1.useState(true),\n      isInitializing = _g[0],\n      setIsInitializing = _g[1];\n\n  react_1.useEffect(function () {\n    if (failedOperation && failedOperation === enums_1.FailedOperationEnum.FetchBank) {\n      setRedirect(React.createElement(react_router_dom_1.Redirect, {\n        to: '/banks'\n      }));\n    }\n  }, [failedOperation]);\n  react_1.useEffect(function () {\n    if (!loggedIn) {\n      dispatch(authActions.setAuthRedirectPath(location.pathname));\n      setRedirect(React.createElement(react_router_dom_1.Redirect, {\n        to: \"/auth/\"\n      }));\n    }\n  }, [loggedIn]);\n  react_1.useEffect(function () {\n    if (!bank) {\n      dispatch(actions.fetchBank(id));\n    }\n  }, [id]);\n  react_1.useEffect(function () {\n    var _a;\n\n    var updatedForm = __assign({}, formControls);\n\n    if (bank && updatedForm && isInitializing) {\n      console.log(bank.grade);\n      updatedForm = __assign(__assign({}, updatedForm), (_a = {}, _a['name'] = __assign(__assign({}, updatedForm['name']), {\n        value: bank.name,\n        valid: true\n      }), _a['grade'] = __assign(__assign({}, updatedForm['grade']), {\n        value: 2,\n        valid: true\n      }), _a));\n      setIsInitializing(false);\n    }\n\n    setFormControls(updatedForm);\n  }, [bank]);\n  react_1.useEffect(function () {\n    setIsFormValid(utility_1.ValidateForm(formControls));\n  }, [formControls]);\n  react_1.useEffect(function () {\n    switch (successfulOperation) {\n      case enums_1.SuccessfulOperationEnum.Update:\n        cancelHandler();\n        break;\n\n      case enums_1.SuccessfulOperationEnum.Delete:\n        setRedirect(React.createElement(react_router_dom_1.Redirect, {\n          to: \"/banks/\"\n        }));\n        break;\n    }\n  }, [successfulOperation]);\n\n  var elementHandler = function elementHandler(event, id) {\n    console.log(event);\n    setFormControls(utility_1.getUpdatedForm(event, formControls, id));\n  };\n\n  var cancelHandler = react_1.useCallback(function () {\n    setRedirect(React.createElement(react_router_dom_1.Redirect, {\n      to: \"/banks/\" + id\n    }));\n  }, [id, setRedirect]);\n\n  var saveHandler = function saveHandler(event) {\n    event.preventDefault();\n    var bank = {\n      id: id,\n      name: formControls.name.value.toString(),\n      grade: parseInt(formControls.grade.value.toString())\n    };\n    dispatch(actions.saveBank(bank, token));\n  };\n\n  var deleteConfirmContent = react_1.useMemo(function () {\n    return React.createElement(Modal_1.default, {\n      isShown: isDeleteConfirmShown,\n      type: enums_1.ModalTypeEnum.Component\n    }, React.createElement(ConfirmDelete_1.default, {\n      onOK: function onOK() {\n        return confirmDeleteHandler(true);\n      },\n      onCancel: function onCancel() {\n        return confirmDeleteHandler(false);\n      }\n    }));\n  }, [isDeleteConfirmShown]);\n  var deleteHandler = react_1.useCallback(function () {\n    setIsDeleteConfirmShown(true);\n  }, [setIsDeleteConfirmShown]);\n  var confirmDeleteHandler = react_1.useCallback(function (isConfirmed) {\n    if (isConfirmed) {\n      dispatch(actions.deleteBank(id, token));\n    }\n\n    setIsDeleteConfirmShown(false);\n  }, [id, token, setIsDeleteConfirmShown]);\n  var formElements = utility_1.getFormElements(formControls).map(function (formElement) {\n    return React.createElement(FormElement_1.default, {\n      formElement: formElement,\n      key: formElement.id,\n      onChange: function onChange(event) {\n        return elementHandler(event, formElement.id);\n      },\n      onLostFocus: function onLostFocus(event) {\n        return elementHandler(event, formElement.id);\n      }\n    });\n  });\n  return React.createElement(\"div\", null, redirect, deleteConfirmContent, React.createElement(\"form\", {\n    onSubmit: saveHandler\n  }, formElements, React.createElement(\"div\", {\n    className: \"row\"\n  }, React.createElement(\"div\", {\n    className: \"col-12 text-center\"\n  }, React.createElement(\"button\", {\n    className: \"btn btn-primary\",\n    type: \"reset\"\n  }, \"Clear\"), React.createElement(\"button\", {\n    className: \"btn btn-success\",\n    type: \"submit\",\n    disabled: !isFormValid || loading\n  }, \"Save\"), React.createElement(\"button\", {\n    className: \"btn btn-danger\",\n    type: \"button\",\n    onClick: deleteHandler\n  }, \" Delete\"), React.createElement(\"button\", {\n    className: \"btn btn-warning\",\n    type: \"button\",\n    onClick: cancelHandler\n  }, \" Cancel\")))));\n});\nexports.default = BankEdit;","map":{"version":3,"sources":["BankEdit.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA,IAAA,KAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;AACA,IAAA,OAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;AACA,IAAA,kBAAA,GAAA,OAAA,CAAA,kBAAA,CAAA;;AACA,IAAA,aAAA,GAAA,OAAA,CAAA,aAAA,CAAA;;AAEA,IAAA,SAAA,GAAA,OAAA,CAAA,yBAAA,CAAA;;AACA,IAAA,aAAA,GAAA,OAAA,CAAA,kCAAA,CAAA;;AACA,IAAA,eAAA,GAAA,OAAA,CAAA,sCAAA,CAAA;;AACA,IAAA,OAAA,GAAA,OAAA,CAAA,sBAAA,CAAA;;AACA,IAAA,OAAA,GAAA,OAAA,CAAA,uBAAA,CAAA;;AACA,IAAA,OAAA,GAAA,OAAA,CAAA,oCAAA,CAAA;;AACA,IAAA,WAAA,GAAA,OAAA,CAAA,oCAAA,CAAA;;AAaC;AAED,IAAM,gBAAgB,GAA0C;AAC5D,EAAA,IAAI,EAAE;AACF,IAAA,WAAW,EAAE,OAAA,CAAA,eAAA,CAAgB,KAD3B;AAEF,IAAA,aAAa,EAAE;AACX,MAAA,IAAI,EAAE,OAAA,CAAA,qBAAA,CAAsB,IADjB;AAEX,MAAA,WAAW,EAAE;AAFF,KAFb;AAMF,IAAA,KAAK,EAAE,EANL;AAOF,IAAA,UAAU,EAAE;AACR,MAAA,QAAQ,EAAE;AADF,KAPV;AAUF,IAAA,KAAK,EAAE;AAVL,GADsD;AAa5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAA,KAAK,EAAE;AACH,IAAA,WAAW,EAAE,OAAA,CAAA,eAAA,CAAgB,MAD1B;AAEH,IAAA,aAAa,EAAE;AACX,MAAA,WAAW,EAAE,OADF;AAEX,MAAA,OAAO,EAAE,CACL;AAAE,QAAA,KAAK,EAAE,EAAT;AAAa,QAAA,IAAI,EAAE;AAAnB,OADK,EAEL;AAAE,QAAA,KAAK,EAAE,GAAT;AAAc,QAAA,IAAI,EAAE;AAApB,OAFK,EAGL;AAAE,QAAA,KAAK,EAAE,GAAT;AAAc,QAAA,IAAI,EAAE;AAApB,OAHK,EAIL;AAAE,QAAA,KAAK,EAAE,GAAT;AAAc,QAAA,IAAI,EAAE;AAApB,OAJK,EAKL;AAAE,QAAA,KAAK,EAAE,GAAT;AAAc,QAAA,IAAI,EAAE;AAApB,OALK,EAML;AAAE,QAAA,KAAK,EAAE,GAAT;AAAc,QAAA,IAAI,EAAE;AAApB,OANK;AAFE,KAFZ;AAaH,IAAA,KAAK,EAAE,EAbJ;AAcH,IAAA,UAAU,EAAE,EAdT;AAgBH,IAAA,KAAK,EAAE;AAhBJ;AAzBqD,CAAhE;AA6CA,IAAM,QAAQ,GAAuB,OAAA,CAAA,IAAA,CAAK,UAAC,EAAD,EAAO;MAAJ,EAAE,GAAA,EAAA,CAAA,E;;AAErC,MAAA,EAAA,GAAuF,aAAA,CAAA,WAAA,CAAY,UAAC,KAAD,EAAgB;AAAK,WAAC;AAC3H,MAAA,IAAI,EAAE,KAAK,CAAC,IAAN,CAAW,YAD0G;AAE3H,MAAA,QAAQ,EAAE,KAAK,CAAC,IAAN,CAAW,QAFsG;AAG3H,MAAA,KAAK,EAAE,KAAK,CAAC,IAAN,CAAW,KAHyG;AAI3H,MAAA,OAAO,EAAE,KAAK,CAAC,MAAN,CAAa,SAJqG;AAK3H,MAAA,mBAAmB,EAAE,KAAK,CAAC,MAAN,CAAa,mBALyF;AAM3H,MAAA,eAAe,EAAE,KAAK,CAAC,MAAN,CAAa;AAN6F,KAAD;AAO5H,GAP2F,CAAvF;AAAA,MAAE,IAAI,GAAA,EAAA,CAAA,IAAN;AAAA,MAAQ,QAAQ,GAAA,EAAA,CAAA,QAAhB;AAAA,MAAkB,KAAK,GAAA,EAAA,CAAA,KAAvB;AAAA,MAAyB,OAAO,GAAA,EAAA,CAAA,OAAhC;AAAA,MAAkC,mBAAmB,GAAA,EAAA,CAAA,mBAArD;AAAA,MAAuD,eAAe,GAAA,EAAA,CAAA,eAAtE;;AAQN,MAAM,QAAQ,GAAG,aAAA,CAAA,WAAA,EAAjB;AACA,MAAM,QAAQ,GAAG,kBAAA,CAAA,WAAA,EAAjB;;AACM,MAAA,EAAA,GAAkC,OAAA,CAAA,QAAA,CAAS,gBAAT,CAAlC;AAAA,MAAC,YAAY,GAAA,EAAA,CAAA,CAAA,CAAb;AAAA,MAAe,eAAe,GAAA,EAAA,CAAA,CAAA,CAA9B;;AACA,MAAA,EAAA,GAAgC,OAAA,CAAA,QAAA,CAAS,KAAT,CAAhC;AAAA,MAAC,WAAW,GAAA,EAAA,CAAA,CAAA,CAAZ;AAAA,MAAc,cAAc,GAAA,EAAA,CAAA,CAAA,CAA5B;;AACA,MAAA,EAAA,GAA0B,OAAA,CAAA,QAAA,EAA1B;AAAA,MAAC,QAAQ,GAAA,EAAA,CAAA,CAAA,CAAT;AAAA,MAAW,WAAW,GAAA,EAAA,CAAA,CAAA,CAAtB;;AACA,MAAA,EAAA,GAAkD,OAAA,CAAA,QAAA,CAAS,KAAT,CAAlD;AAAA,MAAC,oBAAoB,GAAA,EAAA,CAAA,CAAA,CAArB;AAAA,MAAuB,uBAAuB,GAAA,EAAA,CAAA,CAAA,CAA9C;;AACA,MAAA,EAAA,GAAsC,OAAA,CAAA,QAAA,CAAS,IAAT,CAAtC;AAAA,MAAC,cAAc,GAAA,EAAA,CAAA,CAAA,CAAf;AAAA,MAAiB,iBAAiB,GAAA,EAAA,CAAA,CAAA,CAAlC;;AAEN,EAAA,OAAA,CAAA,SAAA,CAAU,YAAA;AACN,QAAI,eAAe,IAAI,eAAe,KAAK,OAAA,CAAA,mBAAA,CAAoB,SAA/D,EAA0E;AACtE,MAAA,WAAW,CAAC,KAAA,CAAA,aAAA,CAAC,kBAAA,CAAA,QAAD,EAAS;AAAC,QAAA,EAAE,EAAE;AAAL,OAAT,CAAD,CAAX;AACH;AACJ,GAJD,EAIG,CAAC,eAAD,CAJH;AAMA,EAAA,OAAA,CAAA,SAAA,CAAU,YAAA;AACN,QAAI,CAAC,QAAL,EAAe;AACX,MAAA,QAAQ,CAAC,WAAW,CAAC,mBAAZ,CAAgC,QAAQ,CAAC,QAAzC,CAAD,CAAR;AACA,MAAA,WAAW,CAAC,KAAA,CAAA,aAAA,CAAC,kBAAA,CAAA,QAAD,EAAS;AAAC,QAAA,EAAE,EAAC;AAAJ,OAAT,CAAD,CAAX;AACH;AACJ,GALD,EAKG,CAAC,QAAD,CALH;AAOA,EAAA,OAAA,CAAA,SAAA,CAAU,YAAA;AACN,QAAI,CAAC,IAAL,EAAW;AACP,MAAA,QAAQ,CAAC,OAAO,CAAC,SAAR,CAAkB,EAAlB,CAAD,CAAR;AACH;AACJ,GAJD,EAIG,CAAC,EAAD,CAJH;AAMA,EAAA,OAAA,CAAA,SAAA,CAAU,YAAA;;;AACN,QAAI,WAAW,GAAA,QAAA,CAAA,EAAA,EACR,YADQ,CAAf;;AAGA,QAAI,IAAI,IAAI,WAAR,IAAuB,cAA3B,EAA2C;AACvC,MAAA,OAAO,CAAC,GAAR,CAAY,IAAI,CAAC,KAAjB;AACA,MAAA,WAAW,GAAA,QAAA,CAAA,QAAA,CAAA,EAAA,EACJ,WADI,CAAA,GACO,EAAA,GAAA,EAAA,EAAA,EAAA,CACb,MADa,CAAA,GACP,QAAA,CAAA,QAAA,CAAA,EAAA,EACA,WAAW,CAAC,MAAD,CADX,CAAA,EACmB;AACtB,QAAA,KAAK,EAAE,IAAI,CAAC,IADU;AAEtB,QAAA,KAAK,EAAE;AAFe,OADnB,CADO,EAIC,EAAA,CAEd,OAFc,CAAA,GAEP,QAAA,CAAA,QAAA,CAAA,EAAA,EACD,WAAW,CAAC,OAAD,CADV,CAAA,EACmB;AACvB,QAAA,KAAK,EAAE,CADgB;AAEvB,QAAA,KAAK,EAAE;AAFgB,OADnB,CANM,EASC,EAVR,EAAX;AAaA,MAAA,iBAAiB,CAAC,KAAD,CAAjB;AACH;;AACD,IAAA,eAAe,CAAC,WAAD,CAAf;AACH,GAtBD,EAsBG,CAAC,IAAD,CAtBH;AAwBA,EAAA,OAAA,CAAA,SAAA,CAAU,YAAA;AACN,IAAA,cAAc,CAAC,SAAA,CAAA,YAAA,CAAa,YAAb,CAAD,CAAd;AACH,GAFD,EAEG,CAAC,YAAD,CAFH;AAIA,EAAA,OAAA,CAAA,SAAA,CAAU,YAAA;AACN,YAAQ,mBAAR;AACI,WAAK,OAAA,CAAA,uBAAA,CAAwB,MAA7B;AACI,QAAA,aAAa;AACb;;AACJ,WAAK,OAAA,CAAA,uBAAA,CAAwB,MAA7B;AACI,QAAA,WAAW,CAAC,KAAA,CAAA,aAAA,CAAC,kBAAA,CAAA,QAAD,EAAS;AAAC,UAAA,EAAE,EAAC;AAAJ,SAAT,CAAD,CAAX;AACA;AANR;AAQH,GATD,EASG,CAAC,mBAAD,CATH;;AAWA,MAAM,cAAc,GAAG,SAAjB,cAAiB,CAAC,KAAD,EAAa,EAAb,EAAuB;AAC1C,IAAA,OAAO,CAAC,GAAR,CAAY,KAAZ;AACA,IAAA,eAAe,CAAC,SAAA,CAAA,cAAA,CAAe,KAAf,EAAsB,YAAtB,EAAoC,EAApC,CAAD,CAAf;AACH,GAHD;;AAKA,MAAM,aAAa,GAAG,OAAA,CAAA,WAAA,CAAY,YAAA;AAC9B,IAAA,WAAW,CAAC,KAAA,CAAA,aAAA,CAAC,kBAAA,CAAA,QAAD,EAAS;AAAC,MAAA,EAAE,EAAE,YAAU;AAAf,KAAT,CAAD,CAAX;AACH,GAFqB,EAEnB,CAAC,EAAD,EAAK,WAAL,CAFmB,CAAtB;;AAIA,MAAM,WAAW,GAAG,SAAd,WAAc,CAAC,KAAD,EAAW;AAC3B,IAAA,KAAK,CAAC,cAAN;AACA,QAAM,IAAI,GAAS;AACf,MAAA,EAAE,EAAE,EADW;AAEf,MAAA,IAAI,EAAE,YAAY,CAAC,IAAb,CAAkB,KAAlB,CAAwB,QAAxB,EAFS;AAGf,MAAA,KAAK,EAAE,QAAQ,CAAC,YAAY,CAAC,KAAb,CAAmB,KAAnB,CAAyB,QAAzB,EAAD;AAHA,KAAnB;AAKA,IAAA,QAAQ,CAAC,OAAO,CAAC,QAAR,CAAiB,IAAjB,EAAuB,KAAvB,CAAD,CAAR;AACH,GARD;;AAUA,MAAM,oBAAoB,GAAG,OAAA,CAAA,OAAA,CAAQ,YAAA;AACjC,WACI,KAAA,CAAA,aAAA,CAAC,OAAA,CAAA,OAAD,EAAM;AAAC,MAAA,OAAO,EAAE,oBAAV;AAAgC,MAAA,IAAI,EAAE,OAAA,CAAA,aAAA,CAAc;AAApD,KAAN,EACI,KAAA,CAAA,aAAA,CAAC,eAAA,CAAA,OAAD,EAAc;AAAC,MAAA,IAAI,EAAE,gBAAA;AAAM,eAAA,oBAAoB,CAApB,IAAoB,CAApB;AAA0B,OAAvC;AACV,MAAA,QAAQ,EAAE,oBAAA;AAAM,eAAA,oBAAoB,CAApB,KAAoB,CAApB;AAA2B;AADjC,KAAd,CADJ,CADJ;AAMH,GAP4B,EAO1B,CAAC,oBAAD,CAP0B,CAA7B;AASA,MAAM,aAAa,GAAG,OAAA,CAAA,WAAA,CAAY,YAAA;AAC9B,IAAA,uBAAuB,CAAC,IAAD,CAAvB;AACH,GAFqB,EAEnB,CAAC,uBAAD,CAFmB,CAAtB;AAIA,MAAM,oBAAoB,GAAG,OAAA,CAAA,WAAA,CAAY,UAAC,WAAD,EAAY;AACjD,QAAI,WAAJ,EAAiB;AACb,MAAA,QAAQ,CAAC,OAAO,CAAC,UAAR,CAAmB,EAAnB,EAAuB,KAAvB,CAAD,CAAR;AACH;;AACD,IAAA,uBAAuB,CAAC,KAAD,CAAvB;AACH,GAL4B,EAK1B,CAAC,EAAD,EAAK,KAAL,EAAY,uBAAZ,CAL0B,CAA7B;AAOA,MAAM,YAAY,GAAmB,SAAA,CAAA,eAAA,CAAgB,YAAhB,EAA8B,GAA9B,CAAkC,UAAC,WAAD,EAAgC;AAAK,WACxG,KAAA,CAAA,aAAA,CAAC,aAAA,CAAA,OAAD,EAAY;AAAC,MAAA,WAAW,EAAE,WAAd;AACR,MAAA,GAAG,EAAE,WAAW,CAAC,EADT;AAER,MAAA,QAAQ,EAAE,kBAAC,KAAD,EAAM;AAAK,eAAA,cAAc,CAAC,KAAD,EAAQ,WAAW,CAAjC,EAAc,CAAd;AAAqC,OAFlD;AAGR,MAAA,WAAW,EAAE,qBAAC,KAAD,EAAM;AAAK,eAAA,cAAc,CAAC,KAAD,EAAQ,WAAW,CAAjC,EAAc,CAAd;AAJ4E;AAC5F,KAAZ,CADwG;AAKrG,GAL8B,CAArC;AAOA,SACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA,IAAA,EACK,QADL,EAEK,oBAFL,EAII,KAAA,CAAA,aAAA,CAAA,MAAA,EAAA;AAAM,IAAA,QAAQ,EAAE;AAAhB,GAAA,EACK,YADL,EAGI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,IAAA,SAAS,EAAC;AAAf,GAAA,EACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,IAAA,SAAS,EAAC;AAAf,GAAA,EACI,KAAA,CAAA,aAAA,CAAA,QAAA,EAAA;AAAQ,IAAA,SAAS,EAAC,iBAAlB;AAAoC,IAAA,IAAI,EAAC;AAAzC,GAAA,EAAgD,OAAhD,CADJ,EAEI,KAAA,CAAA,aAAA,CAAA,QAAA,EAAA;AAAQ,IAAA,SAAS,EAAC,iBAAlB;AAAoC,IAAA,IAAI,EAAC,QAAzC;AAAkD,IAAA,QAAQ,EAAE,CAAC,WAAD,IAAgB;AAA5E,GAAA,EAAmF,MAAnF,CAFJ,EAGI,KAAA,CAAA,aAAA,CAAA,QAAA,EAAA;AAAQ,IAAA,SAAS,EAAC,gBAAlB;AAAmC,IAAA,IAAI,EAAC,QAAxC;AAAiD,IAAA,OAAO,EAAE;AAA1D,GAAA,EAAuE,SAAvE,CAHJ,EAII,KAAA,CAAA,aAAA,CAAA,QAAA,EAAA;AAAQ,IAAA,SAAS,EAAC,iBAAlB;AAAoC,IAAA,IAAI,EAAC,QAAzC;AAAkD,IAAA,OAAO,EAAE;AAA3D,GAAA,EAAwE,SAAxE,CAJJ,CADJ,CAHJ,CAJJ,CADJ;AAmBH,CA7IoC,CAArC;AA+IA,OAAA,CAAA,OAAA,GAAe,QAAf","sourceRoot":"","sourcesContent":["\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar React = require(\"react\");\r\nvar react_1 = require(\"react\");\r\nvar react_router_dom_1 = require(\"react-router-dom\");\r\nvar react_redux_1 = require(\"react-redux\");\r\nvar utility_1 = require(\"../../../shared/utility\");\r\nvar FormElement_1 = require(\"../../UI/FormElement/FormElement\");\r\nvar ConfirmDelete_1 = require(\"../../UI/ConfirmDelete/ConfirmDelete\");\r\nvar Modal_1 = require(\"../../UI/Modal/Modal\");\r\nvar enums_1 = require(\"../../../shared/enums\");\r\nvar actions = require(\"../../../store/actions/bankActions\");\r\nvar authActions = require(\"../../../store/actions/authActions\");\r\n;\r\nvar initialFormState = {\r\n    name: {\r\n        elementType: enums_1.ElementTypeEnum.Input,\r\n        elementConfig: {\r\n            type: enums_1.ElementConfigTypeEnum.Text,\r\n            placeholder: 'Name',\r\n        },\r\n        value: '',\r\n        validation: {\r\n            required: true\r\n        },\r\n        valid: false\r\n    },\r\n    //grade: {\r\n    //    elementType: ElementTypeEnum.Input,\r\n    //    elementConfig: {\r\n    //        type: ElementConfigTypeEnum.Number,\r\n    //        placeholder: 'Grade',\r\n    //    },\r\n    //    value: '',\r\n    //    validation: {\r\n    //        required: true\r\n    //    },\r\n    //    valid: false\r\n    //}\r\n    grade: {\r\n        elementType: enums_1.ElementTypeEnum.Select,\r\n        elementConfig: {\r\n            placeholder: 'Grade',\r\n            options: [\r\n                { value: '', text: '---' },\r\n                { value: '1', text: 'A' },\r\n                { value: '2', text: 'B' },\r\n                { value: '3', text: 'C' },\r\n                { value: '4', text: 'D' },\r\n                { value: '5', text: 'E' }\r\n            ],\r\n        },\r\n        value: '',\r\n        validation: {},\r\n        valid: true\r\n    }\r\n};\r\nvar BankEdit = react_1.memo(function (_a) {\r\n    var id = _a.id;\r\n    var _b = react_redux_1.useSelector(function (state) { return ({\r\n        bank: state.bank.selectedBank,\r\n        loggedIn: state.auth.loggedIn,\r\n        token: state.auth.token,\r\n        loading: state.common.isLoading,\r\n        successfulOperation: state.common.successfulOperation,\r\n        failedOperation: state.common.failedOperation\r\n    }); }), bank = _b.bank, loggedIn = _b.loggedIn, token = _b.token, loading = _b.loading, successfulOperation = _b.successfulOperation, failedOperation = _b.failedOperation;\r\n    var dispatch = react_redux_1.useDispatch();\r\n    var location = react_router_dom_1.useLocation();\r\n    var _c = react_1.useState(initialFormState), formControls = _c[0], setFormControls = _c[1];\r\n    var _d = react_1.useState(false), isFormValid = _d[0], setIsFormValid = _d[1];\r\n    var _e = react_1.useState(), redirect = _e[0], setRedirect = _e[1];\r\n    var _f = react_1.useState(false), isDeleteConfirmShown = _f[0], setIsDeleteConfirmShown = _f[1];\r\n    var _g = react_1.useState(true), isInitializing = _g[0], setIsInitializing = _g[1];\r\n    react_1.useEffect(function () {\r\n        if (failedOperation && failedOperation === enums_1.FailedOperationEnum.FetchBank) {\r\n            setRedirect(React.createElement(react_router_dom_1.Redirect, { to: '/banks' }));\r\n        }\r\n    }, [failedOperation]);\r\n    react_1.useEffect(function () {\r\n        if (!loggedIn) {\r\n            dispatch(authActions.setAuthRedirectPath(location.pathname));\r\n            setRedirect(React.createElement(react_router_dom_1.Redirect, { to: \"/auth/\" }));\r\n        }\r\n    }, [loggedIn]);\r\n    react_1.useEffect(function () {\r\n        if (!bank) {\r\n            dispatch(actions.fetchBank(id));\r\n        }\r\n    }, [id]);\r\n    react_1.useEffect(function () {\r\n        var _a;\r\n        var updatedForm = __assign({}, formControls);\r\n        if (bank && updatedForm && isInitializing) {\r\n            console.log(bank.grade);\r\n            updatedForm = __assign(__assign({}, updatedForm), (_a = {}, _a['name'] = __assign(__assign({}, updatedForm['name']), { value: bank.name, valid: true }), _a['grade'] = __assign(__assign({}, updatedForm['grade']), { value: 2, valid: true }), _a));\r\n            setIsInitializing(false);\r\n        }\r\n        setFormControls(updatedForm);\r\n    }, [bank]);\r\n    react_1.useEffect(function () {\r\n        setIsFormValid(utility_1.ValidateForm(formControls));\r\n    }, [formControls]);\r\n    react_1.useEffect(function () {\r\n        switch (successfulOperation) {\r\n            case enums_1.SuccessfulOperationEnum.Update:\r\n                cancelHandler();\r\n                break;\r\n            case enums_1.SuccessfulOperationEnum.Delete:\r\n                setRedirect(React.createElement(react_router_dom_1.Redirect, { to: \"/banks/\" }));\r\n                break;\r\n        }\r\n    }, [successfulOperation]);\r\n    var elementHandler = function (event, id) {\r\n        console.log(event);\r\n        setFormControls(utility_1.getUpdatedForm(event, formControls, id));\r\n    };\r\n    var cancelHandler = react_1.useCallback(function () {\r\n        setRedirect(React.createElement(react_router_dom_1.Redirect, { to: \"/banks/\" + id }));\r\n    }, [id, setRedirect]);\r\n    var saveHandler = function (event) {\r\n        event.preventDefault();\r\n        var bank = {\r\n            id: id,\r\n            name: formControls.name.value.toString(),\r\n            grade: parseInt(formControls.grade.value.toString())\r\n        };\r\n        dispatch(actions.saveBank(bank, token));\r\n    };\r\n    var deleteConfirmContent = react_1.useMemo(function () {\r\n        return (React.createElement(Modal_1.default, { isShown: isDeleteConfirmShown, type: enums_1.ModalTypeEnum.Component },\r\n            React.createElement(ConfirmDelete_1.default, { onOK: function () { return confirmDeleteHandler(true); }, onCancel: function () { return confirmDeleteHandler(false); } })));\r\n    }, [isDeleteConfirmShown]);\r\n    var deleteHandler = react_1.useCallback(function () {\r\n        setIsDeleteConfirmShown(true);\r\n    }, [setIsDeleteConfirmShown]);\r\n    var confirmDeleteHandler = react_1.useCallback(function (isConfirmed) {\r\n        if (isConfirmed) {\r\n            dispatch(actions.deleteBank(id, token));\r\n        }\r\n        setIsDeleteConfirmShown(false);\r\n    }, [id, token, setIsDeleteConfirmShown]);\r\n    var formElements = utility_1.getFormElements(formControls).map(function (formElement) { return (React.createElement(FormElement_1.default, { formElement: formElement, key: formElement.id, onChange: function (event) { return elementHandler(event, formElement.id); }, onLostFocus: function (event) { return elementHandler(event, formElement.id); } })); });\r\n    return (React.createElement(\"div\", null,\r\n        redirect,\r\n        deleteConfirmContent,\r\n        React.createElement(\"form\", { onSubmit: saveHandler },\r\n            formElements,\r\n            React.createElement(\"div\", { className: \"row\" },\r\n                React.createElement(\"div\", { className: \"col-12 text-center\" },\r\n                    React.createElement(\"button\", { className: \"btn btn-primary\", type: \"reset\" }, \"Clear\"),\r\n                    React.createElement(\"button\", { className: \"btn btn-success\", type: \"submit\", disabled: !isFormValid || loading }, \"Save\"),\r\n                    React.createElement(\"button\", { className: \"btn btn-danger\", type: \"button\", onClick: deleteHandler }, \" Delete\"),\r\n                    React.createElement(\"button\", { className: \"btn btn-warning\", type: \"button\", onClick: cancelHandler }, \" Cancel\"))))));\r\n});\r\nexports.default = BankEdit;\r\n//# sourceMappingURL=BankEdit.js.map"]},"metadata":{},"sourceType":"module"}