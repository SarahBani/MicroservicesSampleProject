{"ast":null,"code":"import _slicedToArray from \"H:/Project/Microservices/MicroservicesSampleProject/Client/Client.SPA/ClientApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"H:\\\\Project\\\\Microservices\\\\MicroservicesSampleProject\\\\Client\\\\Client.SPA\\\\ClientApp\\\\src\\\\hoc\\\\withErrorHandler\\\\withErrorHandler.tsx\",\n    _this = this;\n\nimport * as React from 'react';\nimport { Fragment, useState, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport Modal from '../../components/UI/Modal/Modal';\nimport useHttpErrorHandler from '../../hooks/http-error-handler';\nimport axiosInstance from '../../shared/axios-instance';\nimport * as actions from '../../store/actions/commonActions';\nimport { ModalType } from '../../shared/enums';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar withErrorHandler = function withErrorHandler(WrappedComponent) {\n  return function () {\n    var _useSelector = useSelector(function (state) {\n      return {\n        customError: state.common.error\n      };\n    }),\n        customError = _useSelector.customError;\n\n    var dispatch = useDispatch();\n\n    var _useState = useState(),\n        _useState2 = _slicedToArray(_useState, 2),\n        error = _useState2[0],\n        setError = _useState2[1];\n\n    var _useState3 = useState(),\n        _useState4 = _slicedToArray(_useState3, 2),\n        errorType = _useState4[0],\n        setErrorType = _useState4[1];\n\n    var _useHttpErrorHandler = useHttpErrorHandler(axiosInstance),\n        _useHttpErrorHandler2 = _slicedToArray(_useHttpErrorHandler, 2),\n        axiosError = _useHttpErrorHandler2[0],\n        axiosClearErrorHandler = _useHttpErrorHandler2[1];\n\n    useEffect(function () {\n      if (axiosError) {\n        setError(axiosError + '!');\n        setErrorType(ModalType.ERROR);\n      } else if (customError) {\n        setError(customError);\n        setErrorType(ModalType.WARNING);\n      } else {\n        setError(null);\n      }\n    }, [axiosError, customError, setError]);\n\n    var hideErrorHandler = function hideErrorHandler() {\n      if (axiosError) {\n        axiosClearErrorHandler();\n      }\n\n      dispatch(actions.clearError());\n    };\n\n    return /*#__PURE__*/_jsxDEV(Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Modal, {\n        type: errorType,\n        isShown: !!error,\n        hide: hideErrorHandler,\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(WrappedComponent, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 17\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 13\n    }, _this);\n  };\n};\n\nexport default (function (WrappedComponent) {\n  return withErrorHandler(WrappedComponent);\n});","map":{"version":3,"sources":["H:/Project/Microservices/MicroservicesSampleProject/Client/Client.SPA/ClientApp/src/hoc/withErrorHandler/withErrorHandler.tsx"],"names":["React","Fragment","useState","useEffect","useDispatch","useSelector","Modal","useHttpErrorHandler","axiosInstance","actions","ModalType","withErrorHandler","WrappedComponent","state","customError","common","error","dispatch","setError","errorType","setErrorType","axiosError","axiosClearErrorHandler","ERROR","WARNING","hideErrorHandler","clearError"],"mappings":";;;;;AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,SAASC,QAAT,EAAmBC,QAAnB,EAA6BC,SAA7B,QAAqE,OAArE;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AAEA,OAAOC,KAAP,MAAkB,iCAAlB;AACA,OAAOC,mBAAP,MAAgC,gCAAhC;AACA,OAAOC,aAAP,MAA0B,6BAA1B;AACA,OAAO,KAAKC,OAAZ,MAAyB,mCAAzB;AACA,SAASC,SAAT,QAA0B,oBAA1B;;;AAWA,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,gBAAD,EAAgC;AAErD,SAAO,YAAM;AAET,uBAAoCP,WAAW,CAAC,UAACQ,KAAD;AAAA,aAAsB;AAClEC,QAAAA,WAAW,EAAED,KAAK,CAACE,MAAN,CAAaC;AADwC,OAAtB;AAAA,KAAD,CAA/C;AAAA,QAAQF,WAAR,gBAAQA,WAAR;;AAGA,QAAMG,QAAQ,GAAGb,WAAW,EAA5B;;AACA,oBAA0BF,QAAQ,EAAlC;AAAA;AAAA,QAAOc,KAAP;AAAA,QAAcE,QAAd;;AACA,qBAAkChB,QAAQ,EAA1C;AAAA;AAAA,QAAOiB,SAAP;AAAA,QAAkBC,YAAlB;;AACA,+BAA6Cb,mBAAmB,CAACC,aAAD,CAAhE;AAAA;AAAA,QAAOa,UAAP;AAAA,QAAmBC,sBAAnB;;AAEAnB,IAAAA,SAAS,CAAC,YAAM;AACZ,UAAIkB,UAAJ,EAAgB;AACZH,QAAAA,QAAQ,CAACG,UAAU,GAAG,GAAd,CAAR;AACAD,QAAAA,YAAY,CAACV,SAAS,CAACa,KAAX,CAAZ;AACH,OAHD,MAIK,IAAIT,WAAJ,EAAiB;AAClBI,QAAAA,QAAQ,CAACJ,WAAD,CAAR;AACAM,QAAAA,YAAY,CAACV,SAAS,CAACc,OAAX,CAAZ;AACH,OAHI,MAIA;AACDN,QAAAA,QAAQ,CAAC,IAAD,CAAR;AACH;AACJ,KAZQ,EAYN,CAACG,UAAD,EAAaP,WAAb,EAA0BI,QAA1B,CAZM,CAAT;;AAcA,QAAMO,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM;AAC3B,UAAIJ,UAAJ,EAAgB;AACZC,QAAAA,sBAAsB;AACzB;;AACDL,MAAAA,QAAQ,CAACR,OAAO,CAACiB,UAAR,EAAD,CAAR;AACH,KALD;;AAOA,wBACI,QAAC,QAAD;AAAA,8BACI,QAAC,KAAD;AAAO,QAAA,IAAI,EAAEP,SAAb;AAAqC,QAAA,OAAO,EAAE,CAAC,CAACH,KAAhD;AAAuD,QAAA,IAAI,EAAES,gBAA7D;AAAA,kBACKT;AADL;AAAA;AAAA;AAAA;AAAA,eADJ,eAII,QAAC,gBAAD;AAAA;AAAA;AAAA;AAAA,eAJJ;AAAA;AAAA;AAAA;AAAA;AAAA,aADJ;AASH,GAxCD;AAyCH,CA3CD;;AA6CA,gBAAe,UAACJ,gBAAD;AAAA,SAAgCD,gBAAgB,CAACC,gBAAD,CAAhD;AAAA,CAAf","sourcesContent":["import * as React from 'react';\r\nimport { Fragment, useState, useEffect, FC, FunctionComponent } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport Modal from '../../components/UI/Modal/Modal';\r\nimport useHttpErrorHandler from '../../hooks/http-error-handler';\r\nimport axiosInstance from '../../shared/axios-instance';\r\nimport * as actions from '../../store/actions/commonActions';\r\nimport { ModalType } from '../../shared/enums';\r\nimport { AppState } from '../../store';\r\n\r\ninterface StoreProps {\r\n    customError: string\r\n}\r\n\r\ninterface OwnProps {\r\n    <T>(WrappedComponent: FC<T>);\r\n}\r\n\r\nconst withErrorHandler = (WrappedComponent: OwnProps) => {\r\n\r\n    return () => {\r\n\r\n        const { customError }: StoreProps = useSelector((state: AppState) => ({\r\n            customError: state.common.error\r\n        }));\r\n        const dispatch = useDispatch();\r\n        const [error, setError] = useState<string | null>();\r\n        const [errorType, setErrorType] = useState<ModalType>();\r\n        const [axiosError, axiosClearErrorHandler] = useHttpErrorHandler(axiosInstance);\r\n\r\n        useEffect(() => {\r\n            if (axiosError) {\r\n                setError(axiosError + '!');\r\n                setErrorType(ModalType.ERROR);\r\n            }\r\n            else if (customError) {\r\n                setError(customError);\r\n                setErrorType(ModalType.WARNING);\r\n            }\r\n            else {\r\n                setError(null);\r\n            }\r\n        }, [axiosError, customError, setError]);\r\n\r\n        const hideErrorHandler = () => {\r\n            if (axiosError) {\r\n                axiosClearErrorHandler();\r\n            }\r\n            dispatch(actions.clearError());\r\n        };\r\n\r\n        return (\r\n            <Fragment>\r\n                <Modal type={errorType as ModalType} isShown={!!error} hide={hideErrorHandler} >\r\n                    {error}\r\n                </Modal>\r\n                <WrappedComponent />\r\n            </Fragment>\r\n        );\r\n\r\n    };\r\n};\r\n\r\nexport default (WrappedComponent: OwnProps) => withErrorHandler(WrappedComponent);"]},"metadata":{},"sourceType":"module"}