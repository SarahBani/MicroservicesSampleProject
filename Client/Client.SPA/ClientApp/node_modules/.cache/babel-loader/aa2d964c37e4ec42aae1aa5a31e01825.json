{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar React = require(\"react\");\n\nvar react_1 = require(\"react\");\n\nvar react_router_dom_1 = require(\"react-router-dom\");\n\nvar react_redux_1 = require(\"react-redux\");\n\nvar classes = require(\"./BankNew.module.scss\");\n\nvar utility_1 = require(\"../../../shared/utility\");\n\nvar FormElement_1 = require(\"../../UI/FormElement/FormElement\");\n\nvar enums_1 = require(\"../../../shared/enums\");\n\nvar actions = require(\"../../../store/actions/bankActions\"); //import * as locationActions from '../../../store/actions/locationActions';\n\n\nvar authActions = require(\"../../../store/actions/authActions\");\n\nvar uploadActions = require(\"../../../store/actions/uploadActions\");\n\nvar Constants = require(\"../../../shared/constants\");\n\n;\nvar initialFormState = {\n  name: {\n    elementType: enums_1.ElementTypeEnum.Input,\n    elementConfig: {\n      type: enums_1.ElementConfigTypeEnum.Text,\n      placeholder: 'Name'\n    },\n    value: '',\n    validation: {\n      required: true\n    },\n    valid: false\n  },\n  //grade: {\n  //    elementType: ElementTypeEnum.Input,\n  //    elementConfig: {\n  //        type: ElementConfigTypeEnum.Number,\n  //        placeholder: 'Grade',\n  //        maxLength: 1\n  //    },\n  //    value: '',\n  //    validation: {\n  //        maxLength: 1,\n  //        max: 5\n  //    },\n  //    valid: true\n  //}\n  grade: {\n    elementType: enums_1.ElementTypeEnum.Select,\n    elementConfig: {\n      placeholder: 'Grade',\n      options: [{\n        value: '',\n        text: '---'\n      }, {\n        value: '1',\n        text: 'A'\n      }, {\n        value: '2',\n        text: 'B'\n      }, {\n        value: '3',\n        text: 'C'\n      }, {\n        value: '4',\n        text: 'D'\n      }, {\n        value: '5',\n        text: 'E'\n      }]\n    },\n    value: '',\n    validation: {},\n    valid: true\n  }\n};\nvar BankNew = react_1.memo(function () {\n  var _a = react_redux_1.useSelector(function (state) {\n    return {\n      loggedIn: state.auth.loggedIn,\n      token: state.auth.token,\n      uploadedPercentage: state.upload.fileUploadPercentage,\n      uploadedLogoPath: state.upload.filePath,\n      loading: state.common.isLoading,\n      successfulOperation: state.common.successfulOperation\n    };\n  }),\n      loggedIn = _a.loggedIn,\n      token = _a.token,\n      uploadedPercentage = _a.uploadedPercentage,\n      uploadedLogoPath = _a.uploadedLogoPath,\n      loading = _a.loading,\n      successfulOperation = _a.successfulOperation;\n\n  var dispatch = react_redux_1.useDispatch();\n  var location = react_router_dom_1.useLocation();\n\n  var _b = react_1.useState(initialFormState),\n      formControls = _b[0],\n      setFormControls = _b[1]; //const [logoUrl, setLogoUrl] = useState<string | null>(null);\n\n\n  var logoFileUploader = react_1.useRef(null);\n\n  var _c = react_1.useState(false),\n      isFormValid = _c[0],\n      setIsFormValid = _c[1];\n\n  var _d = react_1.useState(),\n      redirect = _d[0],\n      setRedirect = _d[1];\n\n  react_1.useEffect(function () {\n    return function () {\n      dispatch(uploadActions.reset());\n    };\n  }, []);\n  var logo = react_1.useMemo(function () {\n    if (uploadedLogoPath) {\n      var fileManagerUrl = Constants.FILE_MANAGER_URL;\n      return React.createElement(\"div\", {\n        className: classes.ImageUploader\n      }, React.createElement(\"img\", {\n        src: fileManagerUrl + \"/Resources/Images/Banks/Temp/\" + uploadedLogoPath,\n        className: \"img-response\"\n      }), React.createElement(\"div\", null, React.createElement(\"img\", {\n        className: classes.DeleteImage,\n        src: '/images/delete.png',\n        alt: \"Delete Image\",\n        onClick: function onClick() {\n          return deleteLogoHandler();\n        }\n      })));\n    } else {\n      return React.createElement(\"img\", {\n        src: 'images/no-image.png',\n        className: [\"img-response\", classes.NoImage].join(' ')\n      });\n    }\n  }, [uploadedLogoPath]);\n\n  var deleteLogoHandler = function deleteLogoHandler() {\n    if (logoFileUploader) {\n      logoFileUploader.current.value = '';\n    }\n\n    dispatch(actions.deleteBankLogo(uploadedLogoPath, token));\n  };\n\n  react_1.useEffect(function () {\n    if (!loggedIn) {\n      dispatch(authActions.setAuthRedirectPath(location.pathname));\n      setRedirect(React.createElement(react_router_dom_1.Redirect, {\n        to: \"/auth/\"\n      }));\n    }\n  }, [loggedIn]);\n  react_1.useEffect(function () {\n    setIsFormValid(utility_1.ValidateForm(formControls));\n  }, [formControls]);\n  react_1.useEffect(function () {\n    if (successfulOperation === enums_1.SuccessfulOperationEnum.Insert) {\n      cancelHandler();\n    }\n  }, [successfulOperation]);\n\n  var elementHandler = function elementHandler(event, id) {\n    setFormControls(utility_1.getUpdatedForm(event, formControls, id));\n  };\n\n  var uploadImageHandler = react_1.useCallback(function (event) {\n    var files = event.target.files;\n\n    if (files.length == 0) {\n      return;\n    }\n\n    dispatch(actions.uploadBankLogo(files[0], token));\n  }, []);\n  var cancelHandler = react_1.useCallback(function () {\n    setRedirect(React.createElement(react_router_dom_1.Redirect, {\n      to: \"/banks/\"\n    }));\n  }, [setRedirect]);\n\n  var saveHandler = function saveHandler(event) {\n    event.preventDefault();\n    var bank = {\n      id: 0,\n      name: formControls.name.value.toString(),\n      grade: formControls.grade.value ? parseInt(formControls.grade.value.toString()) : undefined,\n      logoUrl: uploadedLogoPath\n    };\n    dispatch(actions.saveBank(bank, token));\n  };\n\n  var formElements = utility_1.getFormElements(formControls).map(function (formElement) {\n    return React.createElement(FormElement_1.default, {\n      formElement: formElement,\n      key: formElement.id,\n      onChange: function onChange(event) {\n        return elementHandler(event, formElement.id);\n      },\n      onLostFocus: function onLostFocus(event) {\n        return elementHandler(event, formElement.id);\n      }\n    });\n  });\n  return React.createElement(\"div\", {\n    className: classes.BankNew\n  }, redirect, React.createElement(\"form\", {\n    onSubmit: saveHandler\n  }, formElements, React.createElement(\"div\", {\n    className: \"row\"\n  }, React.createElement(\"div\", {\n    className: \"col-12 \"\n  }, logo)), React.createElement(\"div\", {\n    className: \"row\"\n  }, React.createElement(\"div\", {\n    className: \"col-12 \"\n  }, React.createElement(\"input\", {\n    type: \"file\",\n    id: \"customFile\",\n    className: \"form-control-file border\",\n    accept: \"image/*\",\n    onChange: uploadImageHandler,\n    ref: logoFileUploader\n  }))), uploadedPercentage && React.createElement(\"div\", {\n    className: \"row\"\n  }, React.createElement(\"div\", {\n    className: \"col-12\"\n  }, React.createElement(\"progress\", {\n    id: \"file\",\n    value: uploadedPercentage,\n    max: \"100\"\n  }), React.createElement(\"small\", {\n    className: \"align-top\"\n  }, \" \", uploadedPercentage, \"%\"))), React.createElement(\"div\", {\n    className: \"row\"\n  }, React.createElement(\"div\", {\n    className: \"col-12 text-center\"\n  }, React.createElement(\"button\", {\n    className: \"btn btn-primary\",\n    type: \"reset\"\n  }, \"Clear\"), React.createElement(\"button\", {\n    className: \"btn btn-success\",\n    type: \"submit\",\n    disabled: !isFormValid || loading\n  }, \"Save\"), React.createElement(\"button\", {\n    className: \"btn btn-warning\",\n    type: \"button\",\n    onClick: cancelHandler\n  }, \" Cancel\")))));\n});\nexports.default = BankNew;","map":{"version":3,"sources":["BankNew.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar React = require(\"react\");\r\nvar react_1 = require(\"react\");\r\nvar react_router_dom_1 = require(\"react-router-dom\");\r\nvar react_redux_1 = require(\"react-redux\");\r\nvar classes = require(\"./BankNew.module.scss\");\r\nvar utility_1 = require(\"../../../shared/utility\");\r\nvar FormElement_1 = require(\"../../UI/FormElement/FormElement\");\r\nvar enums_1 = require(\"../../../shared/enums\");\r\nvar actions = require(\"../../../store/actions/bankActions\");\r\n//import * as locationActions from '../../../store/actions/locationActions';\r\nvar authActions = require(\"../../../store/actions/authActions\");\r\nvar uploadActions = require(\"../../../store/actions/uploadActions\");\r\nvar Constants = require(\"../../../shared/constants\");\r\n;\r\nvar initialFormState = {\r\n    name: {\r\n        elementType: enums_1.ElementTypeEnum.Input,\r\n        elementConfig: {\r\n            type: enums_1.ElementConfigTypeEnum.Text,\r\n            placeholder: 'Name',\r\n        },\r\n        value: '',\r\n        validation: {\r\n            required: true\r\n        },\r\n        valid: false\r\n    },\r\n    //grade: {\r\n    //    elementType: ElementTypeEnum.Input,\r\n    //    elementConfig: {\r\n    //        type: ElementConfigTypeEnum.Number,\r\n    //        placeholder: 'Grade',\r\n    //        maxLength: 1\r\n    //    },\r\n    //    value: '',\r\n    //    validation: {\r\n    //        maxLength: 1,\r\n    //        max: 5\r\n    //    },\r\n    //    valid: true\r\n    //}\r\n    grade: {\r\n        elementType: enums_1.ElementTypeEnum.Select,\r\n        elementConfig: {\r\n            placeholder: 'Grade',\r\n            options: [\r\n                { value: '', text: '---' },\r\n                { value: '1', text: 'A' },\r\n                { value: '2', text: 'B' },\r\n                { value: '3', text: 'C' },\r\n                { value: '4', text: 'D' },\r\n                { value: '5', text: 'E' }\r\n            ],\r\n        },\r\n        value: '',\r\n        validation: {},\r\n        valid: true\r\n    }\r\n};\r\nvar BankNew = react_1.memo(function () {\r\n    var _a = react_redux_1.useSelector(function (state) { return ({\r\n        loggedIn: state.auth.loggedIn,\r\n        token: state.auth.token,\r\n        uploadedPercentage: state.upload.fileUploadPercentage,\r\n        uploadedLogoPath: state.upload.filePath,\r\n        loading: state.common.isLoading,\r\n        successfulOperation: state.common.successfulOperation\r\n    }); }), loggedIn = _a.loggedIn, token = _a.token, uploadedPercentage = _a.uploadedPercentage, uploadedLogoPath = _a.uploadedLogoPath, loading = _a.loading, successfulOperation = _a.successfulOperation;\r\n    var dispatch = react_redux_1.useDispatch();\r\n    var location = react_router_dom_1.useLocation();\r\n    var _b = react_1.useState(initialFormState), formControls = _b[0], setFormControls = _b[1];\r\n    //const [logoUrl, setLogoUrl] = useState<string | null>(null);\r\n    var logoFileUploader = react_1.useRef(null);\r\n    var _c = react_1.useState(false), isFormValid = _c[0], setIsFormValid = _c[1];\r\n    var _d = react_1.useState(), redirect = _d[0], setRedirect = _d[1];\r\n    react_1.useEffect(function () {\r\n        return function () {\r\n            dispatch(uploadActions.reset());\r\n        };\r\n    }, []);\r\n    var logo = react_1.useMemo(function () {\r\n        if (uploadedLogoPath) {\r\n            var fileManagerUrl = Constants.FILE_MANAGER_URL;\r\n            return (React.createElement(\"div\", { className: classes.ImageUploader },\r\n                React.createElement(\"img\", { src: fileManagerUrl + \"/Resources/Images/Banks/Temp/\" + uploadedLogoPath, className: \"img-response\" }),\r\n                React.createElement(\"div\", null,\r\n                    React.createElement(\"img\", { className: classes.DeleteImage, src: '/images/delete.png', alt: \"Delete Image\", onClick: function () { return deleteLogoHandler(); } }))));\r\n        }\r\n        else {\r\n            return (React.createElement(\"img\", { src: 'images/no-image.png', className: [\"img-response\", classes.NoImage].join(' ') }));\r\n        }\r\n    }, [uploadedLogoPath]);\r\n    var deleteLogoHandler = function () {\r\n        if (logoFileUploader) {\r\n            logoFileUploader.current.value = '';\r\n        }\r\n        dispatch(actions.deleteBankLogo(uploadedLogoPath, token));\r\n    };\r\n    react_1.useEffect(function () {\r\n        if (!loggedIn) {\r\n            dispatch(authActions.setAuthRedirectPath(location.pathname));\r\n            setRedirect(React.createElement(react_router_dom_1.Redirect, { to: \"/auth/\" }));\r\n        }\r\n    }, [loggedIn]);\r\n    react_1.useEffect(function () {\r\n        setIsFormValid(utility_1.ValidateForm(formControls));\r\n    }, [formControls]);\r\n    react_1.useEffect(function () {\r\n        if (successfulOperation === enums_1.SuccessfulOperationEnum.Insert) {\r\n            cancelHandler();\r\n        }\r\n    }, [successfulOperation]);\r\n    var elementHandler = function (event, id) {\r\n        setFormControls(utility_1.getUpdatedForm(event, formControls, id));\r\n    };\r\n    var uploadImageHandler = react_1.useCallback(function (event) {\r\n        var files = event.target.files;\r\n        if (files.length == 0) {\r\n            return;\r\n        }\r\n        dispatch(actions.uploadBankLogo(files[0], token));\r\n    }, []);\r\n    var cancelHandler = react_1.useCallback(function () {\r\n        setRedirect(React.createElement(react_router_dom_1.Redirect, { to: \"/banks/\" }));\r\n    }, [setRedirect]);\r\n    var saveHandler = function (event) {\r\n        event.preventDefault();\r\n        var bank = {\r\n            id: 0,\r\n            name: formControls.name.value.toString(),\r\n            grade: (formControls.grade.value ? parseInt(formControls.grade.value.toString()) : undefined),\r\n            logoUrl: uploadedLogoPath\r\n        };\r\n        dispatch(actions.saveBank(bank, token));\r\n    };\r\n    var formElements = utility_1.getFormElements(formControls).map(function (formElement) { return (React.createElement(FormElement_1.default, { formElement: formElement, key: formElement.id, onChange: function (event) { return elementHandler(event, formElement.id); }, onLostFocus: function (event) { return elementHandler(event, formElement.id); } })); });\r\n    return (React.createElement(\"div\", { className: classes.BankNew },\r\n        redirect,\r\n        React.createElement(\"form\", { onSubmit: saveHandler },\r\n            formElements,\r\n            React.createElement(\"div\", { className: \"row\" },\r\n                React.createElement(\"div\", { className: \"col-12 \" }, logo)),\r\n            React.createElement(\"div\", { className: \"row\" },\r\n                React.createElement(\"div\", { className: \"col-12 \" },\r\n                    React.createElement(\"input\", { type: \"file\", id: \"customFile\", className: \"form-control-file border\", accept: \"image/*\", onChange: uploadImageHandler, ref: logoFileUploader }))),\r\n            uploadedPercentage &&\r\n                React.createElement(\"div\", { className: \"row\" },\r\n                    React.createElement(\"div\", { className: \"col-12\" },\r\n                        React.createElement(\"progress\", { id: \"file\", value: uploadedPercentage, max: \"100\" }),\r\n                        React.createElement(\"small\", { className: \"align-top\" },\r\n                            \" \",\r\n                            uploadedPercentage,\r\n                            \"%\"))),\r\n            React.createElement(\"div\", { className: \"row\" },\r\n                React.createElement(\"div\", { className: \"col-12 text-center\" },\r\n                    React.createElement(\"button\", { className: \"btn btn-primary\", type: \"reset\" }, \"Clear\"),\r\n                    React.createElement(\"button\", { className: \"btn btn-success\", type: \"submit\", disabled: !isFormValid || loading }, \"Save\"),\r\n                    React.createElement(\"button\", { className: \"btn btn-warning\", type: \"button\", onClick: cancelHandler }, \" Cancel\"))))));\r\n});\r\nexports.default = BankNew;\r\n//# sourceMappingURL=BankNew.js.map"]},"metadata":{},"sourceType":"module"}